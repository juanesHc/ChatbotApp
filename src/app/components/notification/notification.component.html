<div class="page-wrapper">
  <div class="notifications-container">

    <!-- Header -->
    <div class="page-header">
      <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 10-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
      </svg>
      <h2>Notificaciones</h2>
    </div>

    <!-- Filtros -->
    <div class="filter-bar">
      <button class="filter-btn" [class.active]="activeFilter === 'ALL'" (click)="setFilter('ALL')">
        Todos
      </button>
      <button class="filter-btn" [class.active]="activeFilter === 'UNREAD'" (click)="setFilter('UNREAD')">
        No leídos
      </button>
      <button class="filter-btn" [class.active]="activeFilter === 'READ'" (click)="setFilter('READ')">
        Leídos
      </button>
      <button class="filter-btn" [class.active]="activeFilter === 'SENT'" (click)="setFilter('SENT')">
        Enviados
      </button>
    </div>

    <!-- Loading -->
    <div *ngIf="isLoading" class="loading-state">
      <div class="spinner"></div>
      <p>Cargando notificaciones...</p>
    </div>

    <!-- Error -->
    <div *ngIf="errorMessage && !isLoading" class="error-message">
      {{ errorMessage }}
    </div>

    <!-- Empty state -->
    <div *ngIf="!isLoading && !errorMessage && notifications.length === 0" class="empty-state">
      <svg xmlns="http://www.w3.org/2000/svg" width="56" height="56" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
          d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 10-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
      </svg>
      <p>No tienes notificaciones</p>
    </div>

    <!-- Lista -->
    <ul *ngIf="!isLoading && notifications.length > 0" class="notification-list">
      <li *ngFor="let notification of notifications"
        class="notification-card"
        [class.read]="notification.read"
        (click)="markAsRead(notification.notificationId)">

        <div class="notification-dot" [class.dot-read]="notification.read"></div>

        <div class="notification-content">
          <div class="notification-meta">
            <span class="notification-sender">
              <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
              </svg>
              {{ notification.senderName }}
            </span>
          </div>
          <span class="notification-subject" [class.subject-read]="notification.read">
            {{ notification.subject }}
          </span>
          <p class="notification-message">{{ notification.message }}</p>
        </div>

        <button
          class="delete-btn"
          (click)="deleteNotification(notification.notificationId); $event.stopPropagation()"
          [disabled]="deletingId === notification.notificationId"
          title="Eliminar">
          <svg *ngIf="deletingId !== notification.notificationId"
            xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none"
            viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
          </svg>
          <svg *ngIf="deletingId === notification.notificationId"
            class="spin" xmlns="http://www.w3.org/2000/svg" width="20" height="20"
            fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
          </svg>
        </button>

      </li>
    </ul>

  </div>

  <!-- Success Modal -->
  <div *ngIf="showSuccessModal" class="modal-overlay" (click)="closeSuccessModal()">
    <div class="modal-box" (click)="$event.stopPropagation()">
      <div class="modal-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
        </svg>
      </div>
      <p class="modal-message">{{ successMessage }}</p>
      <button class="modal-close-btn" (click)="closeSuccessModal()">Cerrar</button>
    </div>
  </div>

  <button class="btn-back" (click)="goHome()">Home</button>

</div>